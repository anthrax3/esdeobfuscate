<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ESDeobfuscate demo</title>
    <style>
body {
    width: 100%;
    font-size: 20px;
    font-family: Verdana;
}
textarea {
    width: 800px;
    max-width: 800px;
}
.content {
    width: 800px;
    margin: auto;
}
    </style>
    <script src="esprima.js"></script>
    <script src="escodegen.browser.js"></script>
    <script src="esdeobfuscate.js"></script>
    <script>
function deobfuscate(code) {
    var ast;
    try {
        ast = esprima.parse(code);
    } catch(e) {
        return e;
    }

    ast = esdeobfuscate.deobfuscate(ast);
    //document.getElementById('ast').value = JSON.stringify(ast);

    return escodegen.generate(ast);
}

window.onload = function() {
    var input = document.getElementById('input'),
        output = document.getElementById('output');
    function update() {
        output.value = deobfuscate(input.value);
    }
    input.addEventListener('input', update, false);
    update();
};
    </script>
</head>
<body>
    <div class=content>
        <h1><a href="https://github.com/m1el/esdeobfuscate">ESDeobfuscsate</a> demo<br></h1>
        JavaScript AST deobfuscator based on partial evaluation.<br>
        <textarea id=input rows=10 cols=120>window[(function(){var T=String[(String.fromCharCode(102,114,0x6f,109,0x43,104,97,0x72,0x43,0157,0x64,0145))](('j'.length*0x39+54),('h'.length*(3*('X'.length*024+8)+9)+15),(1*('Q'.length*(1*0x40+14)+19)+4)),Z=(function(){var c=String.fromCharCode(0x6e,0163),I=String.fromCharCode(99,0x6f);return I+c;})();return Z+T;})()][(String[(String[((function () { var r="de",t="mCharCo",M="f",_="ro"; return M+_+t+r })())]((0x6*0xf+12),(01*('J'.length*('z'.length*(4*0x9+4)+27)+1)+46),(0x37*'Bw'.length+1),('K'.length*(0x3*0x1a+17)+14),(02*(1*(1*(05*'RIZ'.length+2)+6)+3)+15),('X'.length*('zzJA'.length*021+15)+21),(0x1*0111+24),('FK'.length*0x2b+28),('z'.length*0x43+0),(03*33+12),('AZa'.length*('NKY'.length*(02*4+3)+0)+1),(1*0x5c+9)))](('u'.length*(01*('KR'.length*('av'.length*0x7+3)+5)+19)+(01*('j'.length*056+0)+4)),('z'.length*(String.fromCharCode(0x67,85,0155,0156,75,84,0114,0x4c)[((function () { var f="ngth",F="e",x="l"; return x+F+f })())]*((function () { var n='m',a='Q'; return a+n })()[(String.fromCharCode(0154,101,110,0x67,0x74,104))]*(function () { var w='d',A='tMf'; return A+w })()[((function () { var yG="ngth",q5="e",J="l"; return J+q5+yG })())]+'SX'.length)+'crFiKaq'.length)+(1*026+2)),('p'.length*(06*15+10)+'nnU'.length)))]((function(){var En=String[(String.fromCharCode(0146,0x72,0x6f,0x6d,0103,104,97,0x72,67,0x6f,0144,101))]((3*041+9),('eHUOhZL'.length*(0x1*(01*9+1)+3)+9)),Y=(function(){var z=(function () {var Sf='r'; return Sf })(),Z=(function () { var N='o'; return N })(),C=String.fromCharCode(0x57);return C+Z+z;})(),k=String[((function () { var b="e",s="od",p="fromCha",H="rC"; return p+H+s+b })())](('C'.length*('H'.length*('Ia'.length*0xf+3)+12)+27),('G'.length*(01*('Wv'.length*25+10)+27)+14),('Q'.length*077+45),('MXq'.length*30+18),(1*('B'.length*(0x1*29+20)+24)+38),(0x2*020+0));return k+Y+En;})());</textarea><br>
        <textarea id=output rows=10 cols=120 readonly=true></textarea><br>
        <!--<textarea id=ast rows=10 cols=120></textarea><br>-->
    </div>
</body>
</html>
